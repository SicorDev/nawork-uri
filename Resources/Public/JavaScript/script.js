"use strict";String.prototype.format=function(){var t=arguments,e=0;return this.replace(/(%(s|d))/g,function(s){var i;switch(s){case"%d":i=parseInt(t[e]),isNaN(i)&&(i=0);break;default:i=t[e]}return++e,i})},Number.prototype.forceInRange=function(t,e){return this<t?t:this>e?e:this},function(t){var e=function(e,s){this.$element=t(e),this.options=t.extend({},this.options,s||{}),this.init()};e.prototype={$element:null,options:{inputChangeTimeout:300},filter:null,userSettings:null,ajaxUrl:null,$tableInner:null,controls:{$first:null,$previous:null,$numberOfRecords:null,$page:null,$pagesMax:null,$next:null,$last:null},state:{ajaxCall:null,inputChangeTimeout:null,maxPages:1},init:function(){this.filter=this.$element.data("filter"),this.userSettings=this.$element.data("settings"),this.ajaxUrl=this.$element.data("ajaxUrl"),this.$tableInner=this.$element.find(".urlTable__body__inner"),this.controls.$first=this.$element.find(".js-paginationFirst"),this.controls.$previous=this.$element.find(".js-paginationPrevious"),this.controls.$numberOfRecords=this.$element.find(".js-numberOfRecords"),this.controls.$page=this.$element.find(".js-page"),this.controls.$pagesMax=this.$element.find(".js-pagesMax"),this.controls.$next=this.$element.find(".js-paginationNext"),this.controls.$last=this.$element.find(".js-paginationLast"),this.controls.$reload=this.$element.find(".js-reload"),this.initListener(),this.loadUrls()},initListener:function(){var e=this;t('[name="DomainMenu"]').change(function(){var s=t(this.options[this.selectedIndex]).data("domain");s&&!isNaN(s)&&s!==e.filter.domain&&(e.filter.domain=s,e.loadUrls())}),t('[name="TypesMenu[]"]').change(function(){var s=t(this).data("type");if(s&&s.length>0){if(t(this).is(":checked")&&e.filter.types.indexOf(s)<0)e.filter.types.push(s);else if(!t(this).is(":checked")&&e.filter.types.indexOf(s)>-1){var i=e.filter.types.indexOf(s);isNaN(i)||e.filter.types.splice(i,1)}e.loadUrls()}}),t('[name="LanguageMenu"]').change(function(){var s=parseInt(t(this.options[this.selectedIndex]).data("language"));if(!isNaN(s)){switch(s){case-1:e.filter.ignoreLanguage=1,e.filter.language=null;break;case 0:e.filter.ignoreLanguage=0,e.filter.language=null;break;default:e.filter.ignoreLanguage=0,e.filter.language=s}e.loadUrls()}}),t('[name="ScopeMenu"]').change(function(){var s=t(this.options[this.selectedIndex]).data("scope");s&&s.length>0&&s!==e.filter.scope&&(e.filter.scope=s,e.loadUrls())}),this.$element.find(".t3js-icon").click(function(){var e=t(this);e.toggleClass("icon-state-active");var s=e.siblings(".inputWrapper").find(".urlTable__column__search").toggleClass("isVisible");s.hasClass("isVisible")||s.val("")}),this.$element.find(".js-pathInput").on("customChange",function(){var s=t(this);null!==e.state.inputChangeTimeout&&clearTimeout(e.state.inputChangeTimeout),setTimeout(function(){s.val()!==e.filter.path&&(e.filter.path=s.val(),e.loadUrls())},e.options.inputChangeTimeout)}).keyup(function(){t(this).trigger("customChange")}).change(function(){t(this).trigger("customChange")}),this.$element.find(".js-parametersInput").on("customChange",function(){var s=t(this);null!==e.state.inputChangeTimeout&&clearTimeout(e.state.inputChangeTimeout),setTimeout(function(){s.val()!==e.filter.parameters&&(e.filter.parameters=s.val(),e.loadUrls())},e.options.inputChangeTimeout)}).keyup(function(){t(this).trigger("customChange")}).change(function(){t(this).trigger("customChange")}),this.controls.$first.click(function(){t(this).hasClass("disabled")||(e.filter.offset=0,e.updatePagination(this.filter.offset),e.loadUrls())}),this.controls.$previous.click(function(){t(this).hasClass("disabled")||(e.filter.offset=Math.min(0,e.filter.offset-1),e.updatePagination(this.filter.offset),e.loadUrls())}),this.controls.$previous.click(function(){t(this).hasClass("disabled")||(e.filter.offset=Math.max(e.state.maxPages-1,e.filter.offset+1),e.updatePagination(this.filter.offset),e.loadUrls())}),this.controls.$previous.click(function(){t(this).hasClass("disabled")||(e.filter.offset=e.state.maxPages-1,e.updatePagination(this.filter.offset),e.loadUrls())}),this.controls.$page.keyup(function(){null!==e.state.inputChangeTimeout&&clearTimeout(e.state.inputChangeTimeout),e.state.inputChangeTimeout=setTimeout(function(){var t=parseInt(e.controls.$page.val());if(!isNaN(t)){var s=t.forceInRange(1,e.state.maxPages);s!=e.filter.offset+1?e.filter.offset=s-1:e.updatePagination(e.filter.offset+1)}},e.options.inputChangeTimeout)}),this.controls.$reload.click(function(){e.loadUrls()})},loadUrls:function(){var e=this;this.$tableInner.html('<div class="urlTable__row"><span class="urlTable__column urlTable__column--fullWidth">%s</span></div>'.format(tx_naworkuri_labels.loadingMessage)),null!==this.state.ajaxCall&&this.state.ajaxCall.readyState!==XMLHttpRequest.DONE&&this.state.ajaxCall.abort(),this.state.ajaxCall=t.getJSON(this.ajaxUrl,{tx_naworkuri_naworkuri_naworkuriuri:{filter:this.filter}},function(t){t&&(t.html&&t.html.length>0&&e.$tableInner.html(t.html),t.start&&t.end&&e.controls.$numberOfRecords.text(tx_naworkuri_labels.numberOfRecords.format(t.start,t.end)),t.page&&t.pagesMax&&(e.updatePagination(t.page,t.pagesMax),t.page>1?(e.controls.$first.removeClass("disabled"),e.controls.$previous.removeClass("disabled")):(e.controls.$first.addClass("disabled"),e.controls.$previous.addClass("disabled")),t.page<t.pagesMax?(e.controls.$next.removeClass("disabled"),e.controls.$last.removeClass("disabled")):(e.controls.$next.addClass("disabled"),e.controls.$last.addClass("disabled"))))})},updatePagination:function(t,e){this.controls.$page.val(t),e&&(this.state.maxPages=e,this.controls.$pagesMax.text(e))}},t.fn.UrlModule=function(s){return this.each(function(i,a){t(a).data("urlModule",new e(a,s))})},t(document).ready(function(){t(".urlTable").UrlModule()})}(jQuery);